#!/usr/bin/env python3
import nmap
import json

def scan_ports(target, port_range):
    nm = nmap.PortScanner()
    print(f"Scanning {target} for open ports in range {port_range}...")
    nm.scan(target, port_range)

    open_ports = []
    for host in nm.all_hosts():
        for port in nm[host]['tcp']:
            if nm[host]['tcp'][port]['state'] == 'open':
                open_ports.append({
                    'port': port,
                    'state': nm[host]['tcp'][port]['state'],
                    'service': nm[host]['tcp'][port]['name']
                })

    return open_ports

# Write the results to JSON file
def save_port_scan_to_json(target, port_range):
    results = scan_ports(target, port_range)
    with open('port_scan_results.json', 'w') as json_file:
        json.dump(results, json_file, indent=4)

if __name__ == '__main__':
    target_ip = input("Enter target IP: ")
    port_range = input("Enter port range (e.g., 20-80): ")
    save_port_scan_to_json(target_ip, port_range)

