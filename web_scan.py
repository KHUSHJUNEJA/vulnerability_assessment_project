#!/usr/bin/env python3
import subprocess
import json
import os

# Function to run Nikto scan
def run_nikto_scan(target_url):
    try:
        # Run Nikto command and capture the output
        result = subprocess.run(['nikto', '-h', target_url], capture_output=True, text=True)
        return result.stdout  # Nikto output as text
    except FileNotFoundError:
        print("Error: Nikto is not installed or not found in the system's PATH.")
        return None
    except Exception as e:
        print(f"An error occurred while running Nikto: {e}")
        return None

# Function to save Nikto scan results to a JSON file
def save_nikto_scan_to_json(target_url):
    output = run_nikto_scan(target_url)
    
    if output is None:
        print("Nikto scan could not be completed.")
        return

    # Convert the output to a structured format
    results = {
        'target': target_url,
        'nikto_output': output.splitlines()  # Split text into lines for better structuring
    }

    # Ensure 'reports' directory exists
    if not os.path.exists('reports'):
        os.makedirs('reports')

    # Save to JSON file
    filename = 'reports/nikto_scan_results.json'
    with open(filename, 'w') as json_file:
        json.dump(results, json_file, indent=4)

    print(f"Nikto scan results saved to {filename}")

if __name__ == '__main__':
    target_url = input("Enter target URL: ")
    save_nikto_scan_to_json(target_url)
