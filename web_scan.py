#!/usr/bin/env python3
import subprocess
import json

def run_nikto_scan(target_url):
    result = subprocess.run(['nikto', '-h', target_url], capture_output=True, text=True)
    return result.stdout  # Nikto output as text

def save_nikto_scan_to_json(target_url):
    output = run_nikto_scan(target_url)

    # Convert the output to a simple structure, since Nikto outputs text
    results = {
        'target': target_url,
        'nikto_output': output.splitlines()  # Split text into lines for better structuring
    }

    # Save to JSON file
    with open('nikto_scan_results.json', 'w') as json_file:
        json.dump(results, json_file, indent=4)

if __name__ == '__main__':
    target_url = input("Enter target URL: ")
    save_nikto_scan_to_json(target_url)
